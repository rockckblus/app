<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../../node_modules/leancloud-realtime/dist/realtime.browser.js"></script>

</head>
<body>

<button onclick="send()">send</button>
</body>
<script>
    // 应用 ID，用来识别应用
    var APP_ID = 'jFnAKF8oIWzB7INn2GpNyPAt-gzGzoHsz';

    // 应用 Key，用来校验权限（Web 端可以配置安全域名来保护数据安全）
    var APP_KEY = 'OvRQhBzP5fW4Uer1gLfPbpzl';

    var Realtime = AV.Realtime;
    var TextMessage = AV.TextMessage;

    var realtime = new Realtime({
        appId: APP_ID,
        region: 'cn', //美国节点为 "us"
    });

    var count = 0;

    function send() {
        // Tom 用自己的名字作为 clientId，获取 IMClient 对象实例
        realtime.createIMClient('Tom').then(function (tom) {
            // 创建与Jerry之间的对话
            return tom.createConversation({
                members: ['Jerry2'],
                name: 'Tom & Jerry',
            });
        }).then(function (conversation) {
            count++;
            // 发送消息
            return conversation.send(new TextMessage('耗子，起床！' + count));
        }).then(function (message) {
            console.log('Tom & Jerry', '发送成功！');
        }).catch(console.error);
    }


</script>
</html>